% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calculate_wal.R
\name{calculate_wal}
\alias{calculate_wal}
\title{Calculate Portfolio Weighted Average Life (WAL)}
\usage{
calculate_wal(loan_cash_flows, principal_column = "total_principal")
}
\arguments{
\item{loan_cash_flows}{Data frame. Output from \code{calculate_cash_flows()}
containing projected loan cash flows with required columns: LOAN_ID,
eff_date, date, total_principal, investor_principal.}

\item{principal_column}{Character. Column name for principal cash flows to use.
Options:
\itemize{
\item "total_principal" (default): Full principal cash flows regardless
of ownership structure
\item "investor_principal": Investor's share of principal cash flows
after applying investor_share percentage
}}
}
\value{
A single-row data frame with portfolio-level metric:
\itemize{
\item portfolio_wal: Weighted average life in years
}
}
\description{
Calculates the weighted average life for a loan portfolio based on projected
principal cash flows from \code{calculate_cash_flows()}. WAL measures the
average time (in years) until principal is repaid, weighted by the amount
of principal in each payment.
}
\details{
WAL measures the time-weighted principal repayments and does not include
interest payments or apply discounting. Unlike duration, WAL is not sensitive
to interest rates—it purely reflects the timing and amount of principal
repayment.

The function calculates:
\itemize{
\item Loan-level WAL = Σ(t × Principal_t) / Σ(Principal_t), where t is
time in years from eff_date
\item Portfolio WAL = weighted average of loan-level WALs, weighted by
total principal
}

WAL is commonly used to:
\itemize{
\item Assess prepayment risk and portfolio turnover
\item Compare against duration to understand interest vs principal timing
\item Evaluate reinvestment risk in different rate environments
}
}
\examples{
\dontrun{
# Calculate WAL using total principal
wal_result <- calculate_wal(loan_cash_flows)

# Calculate WAL for investor's economic interest
wal_result <- calculate_wal(
  loan_cash_flows,
  principal_column = "investor_principal"
)
}

}
